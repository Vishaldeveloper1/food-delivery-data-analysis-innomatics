{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "fcdc7032-0457-479b-8ea0-0d95cb114f70",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import sqlite3\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "5be22205-ff93-4e65-bea4-de392187e633",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   order_id  user_id  restaurant_id  order_date  total_amount  \\\n",
      "0         1     2508            450  18-02-2023        842.97   \n",
      "1         2     2693            309  18-01-2023        546.68   \n",
      "2         3     2084            107  15-07-2023        163.93   \n",
      "3         4      319            224  04-10-2023       1155.97   \n",
      "4         5     1064            293  25-12-2023       1321.91   \n",
      "\n",
      "                  restaurant_name  \n",
      "0               New Foods Chinese  \n",
      "1  Ruchi Curry House Multicuisine  \n",
      "2           Spice Kitchen Punjabi  \n",
      "3          Darbar Kitchen Non-Veg  \n",
      "4       Royal Eatery South Indian  \n",
      "(10000, 6)\n"
     ]
    }
   ],
   "source": [
    "orders = pd.read_csv(r\"C:\\Users\\dell\\Downloads\\orders (1).csv\")\n",
    "\n",
    "print(orders.head())\n",
    "print(orders.shape)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a18d7845-e2b6-4523-a0b6-ac7d73c3ccee",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   user_id    name       city membership\n",
      "0        1  User_1    Chennai    Regular\n",
      "1        2  User_2       Pune       Gold\n",
      "2        3  User_3  Bangalore       Gold\n",
      "3        4  User_4  Bangalore    Regular\n",
      "4        5  User_5       Pune       Gold\n",
      "(3000, 4)\n"
     ]
    }
   ],
   "source": [
    "users = pd.read_json(r\"C:\\Users\\dell\\Downloads\\users.json\")\n",
    "\n",
    "print(users.head())\n",
    "print(users.shape)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "de57ee8b-5fbb-4dc9-b9c6-26bc389cdb56",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   restaurant_id restaurant_name  cuisine  rating\n",
      "0              1    Restaurant_1  Chinese     4.8\n",
      "1              2    Restaurant_2   Indian     4.1\n",
      "2              3    Restaurant_3  Mexican     4.3\n",
      "3              4    Restaurant_4  Chinese     4.1\n",
      "4              5    Restaurant_5  Chinese     4.8\n"
     ]
    }
   ],
   "source": [
    "import sqlite3\n",
    "\n",
    "# Connect to database\n",
    "conn = sqlite3.connect(\"restaurants.db\")\n",
    "\n",
    "# Load restaurants table\n",
    "restaurants = pd.read_sql(\"SELECT * FROM restaurants\", conn)\n",
    "\n",
    "print(restaurants.head())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "e0ce65c8-9da0-424c-9499-e0ce34dce4b5",
   "metadata": {},
   "outputs": [
    {
     "ename": "OperationalError",
     "evalue": "table restaurants already exists",
     "output_type": "error",
     "traceback": [
      "\u001b[31m---------------------------------------------------------------------------\u001b[39m",
      "\u001b[31mOperationalError\u001b[39m                          Traceback (most recent call last)",
      "\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[33]\u001b[39m\u001b[32m, line 6\u001b[39m\n\u001b[32m      4\u001b[39m \u001b[38;5;66;03m# Execute SQL file\u001b[39;00m\n\u001b[32m      5\u001b[39m \u001b[38;5;28;01mwith\u001b[39;00m \u001b[38;5;28mopen\u001b[39m(\u001b[33mr\u001b[39m\u001b[33m\"\u001b[39m\u001b[33mC:\u001b[39m\u001b[33m\\\u001b[39m\u001b[33mUsers\u001b[39m\u001b[33m\\\u001b[39m\u001b[33mdell\u001b[39m\u001b[33m\\\u001b[39m\u001b[33mDownloads\u001b[39m\u001b[33m\\\u001b[39m\u001b[33mrestaurants.sql\u001b[39m\u001b[33m\"\u001b[39m) \u001b[38;5;28;01mas\u001b[39;00m file:\n\u001b[32m----> \u001b[39m\u001b[32m6\u001b[39m     \u001b[43mcursor\u001b[49m\u001b[43m.\u001b[49m\u001b[43mexecutescript\u001b[49m\u001b[43m(\u001b[49m\u001b[43mfile\u001b[49m\u001b[43m.\u001b[49m\u001b[43mread\u001b[49m\u001b[43m(\u001b[49m\u001b[43m)\u001b[49m\u001b[43m)\u001b[49m\n\u001b[32m      8\u001b[39m restaurants = pd.read_sql(\u001b[33m\"\u001b[39m\u001b[33mSELECT * FROM restaurants\u001b[39m\u001b[33m\"\u001b[39m, conn)\n",
      "\u001b[31mOperationalError\u001b[39m: table restaurants already exists"
     ]
    }
   ],
   "source": [
    "conn = sqlite3.connect(\"restaurants.db\")\n",
    "cursor = conn.cursor()\n",
    "\n",
    "# Execute SQL file\n",
    "with open(r\"C:\\Users\\dell\\Downloads\\restaurants.sql\") as file:\n",
    "    cursor.executescript(file.read())\n",
    "\n",
    "restaurants = pd.read_sql(\"SELECT * FROM restaurants\", conn)\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "f49ba4f5-3cbf-459a-b333-739c97b61298",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Merge orders with users\n",
    "orders_users = pd.merge(\n",
    "    orders,\n",
    "    users,\n",
    "    on=\"user_id\",\n",
    "    how=\"left\"\n",
    ")\n",
    "\n",
    "# Merge with restaurants\n",
    "final_df = pd.merge(\n",
    "    orders_users,\n",
    "    restaurants,\n",
    "    on=\"restaurant_id\",\n",
    "    how=\"left\"\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "505949eb-b930-4e02-8ae3-2440359eb9f7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   order_id  user_id  restaurant_id  order_date  total_amount  \\\n",
      "0         1     2508            450  18-02-2023        842.97   \n",
      "1         2     2693            309  18-01-2023        546.68   \n",
      "2         3     2084            107  15-07-2023        163.93   \n",
      "3         4      319            224  04-10-2023       1155.97   \n",
      "4         5     1064            293  25-12-2023       1321.91   \n",
      "\n",
      "                restaurant_name_x       name       city membership  \\\n",
      "0               New Foods Chinese  User_2508  Hyderabad    Regular   \n",
      "1  Ruchi Curry House Multicuisine  User_2693       Pune    Regular   \n",
      "2           Spice Kitchen Punjabi  User_2084    Chennai       Gold   \n",
      "3          Darbar Kitchen Non-Veg   User_319  Bangalore       Gold   \n",
      "4       Royal Eatery South Indian  User_1064       Pune    Regular   \n",
      "\n",
      "  restaurant_name_y  cuisine  rating  \n",
      "0    Restaurant_450  Mexican     3.2  \n",
      "1    Restaurant_309   Indian     4.5  \n",
      "2    Restaurant_107  Mexican     4.0  \n",
      "3    Restaurant_224  Chinese     4.8  \n",
      "4    Restaurant_293  Italian     3.0  \n",
      "<class 'pandas.core.frame.DataFrame'>\n",
      "RangeIndex: 10000 entries, 0 to 9999\n",
      "Data columns (total 12 columns):\n",
      " #   Column             Non-Null Count  Dtype  \n",
      "---  ------             --------------  -----  \n",
      " 0   order_id           10000 non-null  int64  \n",
      " 1   user_id            10000 non-null  int64  \n",
      " 2   restaurant_id      10000 non-null  int64  \n",
      " 3   order_date         10000 non-null  object \n",
      " 4   total_amount       10000 non-null  float64\n",
      " 5   restaurant_name_x  10000 non-null  object \n",
      " 6   name               10000 non-null  object \n",
      " 7   city               10000 non-null  object \n",
      " 8   membership         10000 non-null  object \n",
      " 9   restaurant_name_y  10000 non-null  object \n",
      " 10  cuisine            10000 non-null  object \n",
      " 11  rating             10000 non-null  float64\n",
      "dtypes: float64(2), int64(3), object(7)\n",
      "memory usage: 937.6+ KB\n",
      "None\n"
     ]
    }
   ],
   "source": [
    "# Save final dataset\n",
    "final_df.to_csv(r\"final_food_delivery_dataset.csv\", index=False)\n",
    "\n",
    "print(final_df.head())\n",
    "print(final_df.info())\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "fc167d09-d97a-4e14-98ba-c9f01b6f53e3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>order_id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>restaurant_id</th>\n",
       "      <th>order_date</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>restaurant_name_x</th>\n",
       "      <th>name</th>\n",
       "      <th>city</th>\n",
       "      <th>membership</th>\n",
       "      <th>restaurant_name_y</th>\n",
       "      <th>cuisine</th>\n",
       "      <th>rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1</td>\n",
       "      <td>2508</td>\n",
       "      <td>450</td>\n",
       "      <td>18-02-2023</td>\n",
       "      <td>842.97</td>\n",
       "      <td>New Foods Chinese</td>\n",
       "      <td>User_2508</td>\n",
       "      <td>Hyderabad</td>\n",
       "      <td>Regular</td>\n",
       "      <td>Restaurant_450</td>\n",
       "      <td>Mexican</td>\n",
       "      <td>3.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>2</td>\n",
       "      <td>2693</td>\n",
       "      <td>309</td>\n",
       "      <td>18-01-2023</td>\n",
       "      <td>546.68</td>\n",
       "      <td>Ruchi Curry House Multicuisine</td>\n",
       "      <td>User_2693</td>\n",
       "      <td>Pune</td>\n",
       "      <td>Regular</td>\n",
       "      <td>Restaurant_309</td>\n",
       "      <td>Indian</td>\n",
       "      <td>4.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>2084</td>\n",
       "      <td>107</td>\n",
       "      <td>15-07-2023</td>\n",
       "      <td>163.93</td>\n",
       "      <td>Spice Kitchen Punjabi</td>\n",
       "      <td>User_2084</td>\n",
       "      <td>Chennai</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_107</td>\n",
       "      <td>Mexican</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>319</td>\n",
       "      <td>224</td>\n",
       "      <td>04-10-2023</td>\n",
       "      <td>1155.97</td>\n",
       "      <td>Darbar Kitchen Non-Veg</td>\n",
       "      <td>User_319</td>\n",
       "      <td>Bangalore</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_224</td>\n",
       "      <td>Chinese</td>\n",
       "      <td>4.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>5</td>\n",
       "      <td>1064</td>\n",
       "      <td>293</td>\n",
       "      <td>25-12-2023</td>\n",
       "      <td>1321.91</td>\n",
       "      <td>Royal Eatery South Indian</td>\n",
       "      <td>User_1064</td>\n",
       "      <td>Pune</td>\n",
       "      <td>Regular</td>\n",
       "      <td>Restaurant_293</td>\n",
       "      <td>Italian</td>\n",
       "      <td>3.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   order_id  user_id  restaurant_id  order_date  total_amount  \\\n",
       "0         1     2508            450  18-02-2023        842.97   \n",
       "1         2     2693            309  18-01-2023        546.68   \n",
       "2         3     2084            107  15-07-2023        163.93   \n",
       "3         4      319            224  04-10-2023       1155.97   \n",
       "4         5     1064            293  25-12-2023       1321.91   \n",
       "\n",
       "                restaurant_name_x       name       city membership  \\\n",
       "0               New Foods Chinese  User_2508  Hyderabad    Regular   \n",
       "1  Ruchi Curry House Multicuisine  User_2693       Pune    Regular   \n",
       "2           Spice Kitchen Punjabi  User_2084    Chennai       Gold   \n",
       "3          Darbar Kitchen Non-Veg   User_319  Bangalore       Gold   \n",
       "4       Royal Eatery South Indian  User_1064       Pune    Regular   \n",
       "\n",
       "  restaurant_name_y  cuisine  rating  \n",
       "0    Restaurant_450  Mexican     3.2  \n",
       "1    Restaurant_309   Indian     4.5  \n",
       "2    Restaurant_107  Mexican     4.0  \n",
       "3    Restaurant_224  Chinese     4.8  \n",
       "4    Restaurant_293  Italian     3.0  "
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "df = pd.read_csv(\"final_food_delivery_dataset.csv\")\n",
    "df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "87f6c80f-ae12-4801-9512-798dc3430c99",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>order_id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>restaurant_id</th>\n",
       "      <th>order_date</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>restaurant_name_x</th>\n",
       "      <th>name</th>\n",
       "      <th>city</th>\n",
       "      <th>membership</th>\n",
       "      <th>restaurant_name_y</th>\n",
       "      <th>cuisine</th>\n",
       "      <th>rating</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>2084</td>\n",
       "      <td>107</td>\n",
       "      <td>15-07-2023</td>\n",
       "      <td>163.93</td>\n",
       "      <td>Spice Kitchen Punjabi</td>\n",
       "      <td>User_2084</td>\n",
       "      <td>Chennai</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_107</td>\n",
       "      <td>Mexican</td>\n",
       "      <td>4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>319</td>\n",
       "      <td>224</td>\n",
       "      <td>04-10-2023</td>\n",
       "      <td>1155.97</td>\n",
       "      <td>Darbar Kitchen Non-Veg</td>\n",
       "      <td>User_319</td>\n",
       "      <td>Bangalore</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_224</td>\n",
       "      <td>Chinese</td>\n",
       "      <td>4.8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>364</td>\n",
       "      <td>7</td>\n",
       "      <td>05-12-2023</td>\n",
       "      <td>953.30</td>\n",
       "      <td>Ruchi Biryani Punjabi</td>\n",
       "      <td>User_364</td>\n",
       "      <td>Chennai</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_7</td>\n",
       "      <td>Italian</td>\n",
       "      <td>3.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>12</td>\n",
       "      <td>884</td>\n",
       "      <td>423</td>\n",
       "      <td>27-10-2023</td>\n",
       "      <td>1484.65</td>\n",
       "      <td>Royal Tiffins Multicuisine</td>\n",
       "      <td>User_884</td>\n",
       "      <td>Pune</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_423</td>\n",
       "      <td>Indian</td>\n",
       "      <td>3.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14</td>\n",
       "      <td>364</td>\n",
       "      <td>112</td>\n",
       "      <td>24-09-2023</td>\n",
       "      <td>898.24</td>\n",
       "      <td>Grand Cafe Punjabi</td>\n",
       "      <td>User_364</td>\n",
       "      <td>Chennai</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_112</td>\n",
       "      <td>Chinese</td>\n",
       "      <td>3.2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    order_id  user_id  restaurant_id  order_date  total_amount  \\\n",
       "2          3     2084            107  15-07-2023        163.93   \n",
       "3          4      319            224  04-10-2023       1155.97   \n",
       "8          9      364              7  05-12-2023        953.30   \n",
       "11        12      884            423  27-10-2023       1484.65   \n",
       "13        14      364            112  24-09-2023        898.24   \n",
       "\n",
       "             restaurant_name_x       name       city membership  \\\n",
       "2        Spice Kitchen Punjabi  User_2084    Chennai       Gold   \n",
       "3       Darbar Kitchen Non-Veg   User_319  Bangalore       Gold   \n",
       "8        Ruchi Biryani Punjabi   User_364    Chennai       Gold   \n",
       "11  Royal Tiffins Multicuisine   User_884       Pune       Gold   \n",
       "13          Grand Cafe Punjabi   User_364    Chennai       Gold   \n",
       "\n",
       "   restaurant_name_y  cuisine  rating  \n",
       "2     Restaurant_107  Mexican     4.0  \n",
       "3     Restaurant_224  Chinese     4.8  \n",
       "8       Restaurant_7  Italian     3.2  \n",
       "11    Restaurant_423   Indian     3.2  \n",
       "13    Restaurant_112  Chinese     3.2  "
      ]
     },
     "execution_count": 47,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gold_df = df[df[\"membership\"] == \"Gold\"]\n",
    "gold_df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "fe178b47-f244-4725-a521-ab8e8747c6ec",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "city\n",
       "Bangalore     994702.59\n",
       "Chennai      1080909.79\n",
       "Hyderabad     896740.19\n",
       "Pune         1003012.32\n",
       "Name: total_amount, dtype: float64"
      ]
     },
     "execution_count": 49,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "city_revenue = gold_df.groupby(\"city\")[\"total_amount\"].sum()\n",
    "city_revenue\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "460e8a74-acf4-4af2-bbad-b6e601d38378",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Chennai'"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "city_revenue.idxmax()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "1b15abf5-068f-40b5-a38d-93b43b8d39b1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "cuisine\n",
       "Chinese    798.389020\n",
       "Indian     798.466011\n",
       "Italian    799.448578\n",
       "Mexican    808.021344\n",
       "Name: total_amount, dtype: float64"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cuisine_avg = df.groupby(\"cuisine\")[\"total_amount\"].mean()\n",
    "cuisine_avg\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "981cc8a1-c9de-46f0-b05a-ecc36e3a58d9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Mexican'"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "cuisine_avg.idxmax()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "d2b4ebbc-bee7-4810-b3ea-dbf61e763e4d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "user_id\n",
       "1    1289.66\n",
       "2    7564.12\n",
       "3    1839.51\n",
       "4    3741.16\n",
       "5    5742.88\n",
       "Name: total_amount, dtype: float64"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "user_total = df.groupby(\"user_id\")[\"total_amount\"].sum()\n",
    "user_total.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "b8afc2f4-5cf2-4d94-b7a1-e9d6981b6724",
   "metadata": {},
   "outputs": [],
   "source": [
    "high_spend_users = user_total[user_total > 1000]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "d98b8990-0dfe-4852-a91f-b98512f8e832",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "2544"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "high_spend_users.count()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "4b65b745-450f-4f46-a5ea-22a50da8f45f",
   "metadata": {},
   "outputs": [],
   "source": [
    "bins = [3.0, 3.5, 4.0, 4.5, 5.0]\n",
    "labels = [\"3.0 – 3.5\", \"3.6 – 4.0\", \"4.1 – 4.5\", \"4.6 – 5.0\"]\n",
    "\n",
    "df[\"rating_range\"] = pd.cut(\n",
    "    df[\"rating\"],\n",
    "    bins=bins,\n",
    "    labels=labels,\n",
    "    include_lowest=True\n",
    ")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "17080060-6c5e-4277-b5a1-25d396e551f4",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\dell\\AppData\\Local\\Temp\\ipykernel_1384\\2144860672.py:1: FutureWarning: The default of observed=False is deprecated and will be changed to True in a future version of pandas. Pass observed=False to retain current behavior or observed=True to adopt the future default and silence this warning.\n",
      "  rating_revenue = df.groupby(\"rating_range\")[\"total_amount\"].sum()\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "rating_range\n",
       "3.0 – 3.5    2136772.70\n",
       "3.6 – 4.0    1717494.41\n",
       "4.1 – 4.5    1960326.26\n",
       "4.6 – 5.0    2197030.75\n",
       "Name: total_amount, dtype: float64"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rating_revenue = df.groupby(\"rating_range\")[\"total_amount\"].sum()\n",
    "rating_revenue\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "b5b132fc-894a-4a20-ae84-6f0cb4867b92",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'4.6 – 5.0'"
      ]
     },
     "execution_count": 67,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rating_revenue.idxmax()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "72e44bd4-67ee-4e26-9095-ea0025eaed94",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>order_id</th>\n",
       "      <th>user_id</th>\n",
       "      <th>restaurant_id</th>\n",
       "      <th>order_date</th>\n",
       "      <th>total_amount</th>\n",
       "      <th>restaurant_name_x</th>\n",
       "      <th>name</th>\n",
       "      <th>city</th>\n",
       "      <th>membership</th>\n",
       "      <th>restaurant_name_y</th>\n",
       "      <th>cuisine</th>\n",
       "      <th>rating</th>\n",
       "      <th>rating_range</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>3</td>\n",
       "      <td>2084</td>\n",
       "      <td>107</td>\n",
       "      <td>15-07-2023</td>\n",
       "      <td>163.93</td>\n",
       "      <td>Spice Kitchen Punjabi</td>\n",
       "      <td>User_2084</td>\n",
       "      <td>Chennai</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_107</td>\n",
       "      <td>Mexican</td>\n",
       "      <td>4.0</td>\n",
       "      <td>3.6 – 4.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>4</td>\n",
       "      <td>319</td>\n",
       "      <td>224</td>\n",
       "      <td>04-10-2023</td>\n",
       "      <td>1155.97</td>\n",
       "      <td>Darbar Kitchen Non-Veg</td>\n",
       "      <td>User_319</td>\n",
       "      <td>Bangalore</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_224</td>\n",
       "      <td>Chinese</td>\n",
       "      <td>4.8</td>\n",
       "      <td>4.6 – 5.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>9</td>\n",
       "      <td>364</td>\n",
       "      <td>7</td>\n",
       "      <td>05-12-2023</td>\n",
       "      <td>953.30</td>\n",
       "      <td>Ruchi Biryani Punjabi</td>\n",
       "      <td>User_364</td>\n",
       "      <td>Chennai</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_7</td>\n",
       "      <td>Italian</td>\n",
       "      <td>3.2</td>\n",
       "      <td>3.0 – 3.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>12</td>\n",
       "      <td>884</td>\n",
       "      <td>423</td>\n",
       "      <td>27-10-2023</td>\n",
       "      <td>1484.65</td>\n",
       "      <td>Royal Tiffins Multicuisine</td>\n",
       "      <td>User_884</td>\n",
       "      <td>Pune</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_423</td>\n",
       "      <td>Indian</td>\n",
       "      <td>3.2</td>\n",
       "      <td>3.0 – 3.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>14</td>\n",
       "      <td>364</td>\n",
       "      <td>112</td>\n",
       "      <td>24-09-2023</td>\n",
       "      <td>898.24</td>\n",
       "      <td>Grand Cafe Punjabi</td>\n",
       "      <td>User_364</td>\n",
       "      <td>Chennai</td>\n",
       "      <td>Gold</td>\n",
       "      <td>Restaurant_112</td>\n",
       "      <td>Chinese</td>\n",
       "      <td>3.2</td>\n",
       "      <td>3.0 – 3.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    order_id  user_id  restaurant_id  order_date  total_amount  \\\n",
       "2          3     2084            107  15-07-2023        163.93   \n",
       "3          4      319            224  04-10-2023       1155.97   \n",
       "8          9      364              7  05-12-2023        953.30   \n",
       "11        12      884            423  27-10-2023       1484.65   \n",
       "13        14      364            112  24-09-2023        898.24   \n",
       "\n",
       "             restaurant_name_x       name       city membership  \\\n",
       "2        Spice Kitchen Punjabi  User_2084    Chennai       Gold   \n",
       "3       Darbar Kitchen Non-Veg   User_319  Bangalore       Gold   \n",
       "8        Ruchi Biryani Punjabi   User_364    Chennai       Gold   \n",
       "11  Royal Tiffins Multicuisine   User_884       Pune       Gold   \n",
       "13          Grand Cafe Punjabi   User_364    Chennai       Gold   \n",
       "\n",
       "   restaurant_name_y  cuisine  rating rating_range  \n",
       "2     Restaurant_107  Mexican     4.0    3.6 – 4.0  \n",
       "3     Restaurant_224  Chinese     4.8    4.6 – 5.0  \n",
       "8       Restaurant_7  Italian     3.2    3.0 – 3.5  \n",
       "11    Restaurant_423   Indian     3.2    3.0 – 3.5  \n",
       "13    Restaurant_112  Chinese     3.2    3.0 – 3.5  "
      ]
     },
     "execution_count": 69,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "gold_df = df[df[\"membership\"] == \"Gold\"]\n",
    "gold_df.head()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "id": "189628c9-6f5a-4c18-88f8-420b74d4f49b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "city\n",
       "Bangalore    793.223756\n",
       "Chennai      808.459080\n",
       "Hyderabad    806.421034\n",
       "Pune         781.162243\n",
       "Name: total_amount, dtype: float64"
      ]
     },
     "execution_count": 71,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "city_avg_order = gold_df.groupby(\"city\")[\"total_amount\"].mean()\n",
    "city_avg_order\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "0ea1969f-f845-4b7c-9d45-7c599538d798",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Chennai'"
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "city_avg_order.idxmax()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "d8f70994-6921-4a2d-bef1-394b732d4536",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "cuisine\n",
       "Chinese    120\n",
       "Indian     126\n",
       "Italian    126\n",
       "Mexican    128\n",
       "Name: restaurant_id, dtype: int64"
      ]
     },
     "execution_count": 75,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "restaurant_count = df.groupby(\"cuisine\")[\"restaurant_id\"].nunique()\n",
    "restaurant_count\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "6d2f65d6-8626-4a79-942d-407d78b501ce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "cuisine\n",
       "Chinese    1930504.65\n",
       "Indian     1971412.58\n",
       "Italian    2024203.80\n",
       "Mexican    2085503.09\n",
       "Name: total_amount, dtype: float64"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "revenue = df.groupby(\"cuisine\")[\"total_amount\"].sum()\n",
    "revenue\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 81,
   "id": "8e8bf69a-108f-4f1c-9210-41563611647c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "cuisine\n",
       "Chinese    16087.538750\n",
       "Indian     15646.131587\n",
       "Italian    16065.109524\n",
       "Mexican    16292.992891\n",
       "dtype: float64"
      ]
     },
     "execution_count": 81,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "revenue_per_restaurant = revenue / restaurant_count\n",
    "revenue_per_restaurant\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 83,
   "id": "9eb62904-b99b-44d1-9867-4ace8f630801",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'Mexican'"
      ]
     },
     "execution_count": 83,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "revenue_per_restaurant.idxmax()\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 85,
   "id": "9429530a-b393-4602-b3bc-1048235efee3",
   "metadata": {},
   "outputs": [],
   "source": [
    "gold_users = users[users['membership'] == 'Gold']\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "id": "5301c26c-6dfc-4a4f-9bee-472e5e4272c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "gold_orders = orders[orders['user_id'].isin(gold_users['user_id'])]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "id": "68090666-0373-4c92-8278-a756a8d39ea2",
   "metadata": {},
   "outputs": [],
   "source": [
    "gold_orders = orders[orders['user_id'].isin(gold_users['user_id'])]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 93,
   "id": "1e116813-379b-44e9-a1c4-31158116fed1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "4987"
      ]
     },
     "execution_count": 93,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "total_gold_orders = gold_orders.shape[0]\n",
    "total_gold_orders\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "bc3d858a-7593-4ec6-97b0-a5c9afcb905c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total Revenue in Hyderabad: 1889367\n"
     ]
    }
   ],
   "source": [
    "\n",
    "hyderabad_orders = df[df['city'] == 'Hyderabad']\n",
    "total_revenue_hyd = hyderabad_orders['total_amount'].sum()\n",
    "print(f\"Total Revenue in Hyderabad: {round(total_revenue_hyd)}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "id": "6c36d3e4-618e-40d5-8fe6-e7173cb915c6",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total distinct users: 2883\n"
     ]
    }
   ],
   "source": [
    "\n",
    "distinct_users = df['user_id'].nunique()\n",
    "\n",
    "print(f\"Total distinct users: {distinct_users}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "ece5286a-a857-4217-a547-cca44eb85bc4",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Average Order Value for Gold members: 797.15\n"
     ]
    }
   ],
   "source": [
    "\n",
    "\n",
    "gold_members_df = df[df['membership'] == 'Gold']\n",
    "avg_order_value_gold = gold_members_df['total_amount'].mean()\n",
    "print(f\"Average Order Value for Gold members: {round(avg_order_value_gold, 2)}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "id": "8f7f4785-20c6-4a79-bfad-d576c1a68ea7",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Orders for restaurants with rating >= 4.5: 3374\n"
     ]
    }
   ],
   "source": [
    "\n",
    "a hai\n",
    "high_rated_orders = df[df['rating'] >= 4.5]\n",
    "\n",
    "total_high_rated_orders = len(high_rated_orders)\n",
    "\n",
    "print(f\"Orders for restaurants with rating >= 4.5: {total_high_rated_orders}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "id": "28c2e3ad-9d4a-4511-be7d-eab60165ae2f",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Top Revenue City for Gold members: Chennai\n",
      "Number of orders in Chennai by Gold members: 1337\n"
     ]
    }
   ],
   "source": [
    "\n",
    "\n",
    "\n",
    "gold_city_revenue = df[df['membership'] == 'Gold'].groupby('city')['total_amount'].sum()\n",
    "top_city_gold = gold_city_revenue.idxmax()\n",
    "\n",
    "orders_count = len(df[(df['city'] == top_city_gold) & (df['membership'] == 'Gold')])\n",
    "\n",
    "print(f\"Top Revenue City for Gold members: {top_city_gold}\")\n",
    "print(f\"Number of orders in {top_city_gold} by Gold members: {orders_count}\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "b01d4f34-ff99-49a8-afe6-3609402e77ff",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
